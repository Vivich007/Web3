pipeline {
	agent any
	stages {
		stage("Git Checkout"){
			steps{
			    git credentialsId: 'github', url: 'https://github.com/Vivich007/Web3.git'
			}
		}
		stage("Configure Web Servers"){
			steps{
			    echo "Configure Web Servers"
				ansiblePlaybook credentialsId: 'Ansible-Project', disableHostKeyChecking: true, installation: 'Ansible', inventory: 'TomcatServers.ini', playbook: 'TomcatConfig.yml'
				ansiblePlaybook credentialsId: 'Ansible-Project', disableHostKeyChecking: true, installation: 'Ansible', inventory: 'TomcatServers.ini', playbook: 'MavenConfig.yml'
			}
		}
		stage("Maven Build"){
			steps{
			    echo "Build Maven Project"
				sh '/opt/apache-maven-3.9.6/bin/mvn clean package'
			}
		}
		
		stage("Maven Test"){
			steps{
			    echo "Test Maven Project"
				junit stdioRetention: '', testResults: ' target/surefire-reports/*.xml'
				
			}
		}
	}
}
